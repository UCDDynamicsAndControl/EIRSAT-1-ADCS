% !TeX root = EIRSAT_ADCS_Model.tex

\section{Spherical Harmonics}

The set of shperical harmonics is an orthonormal set of functions defined in the unit sphere. They are given as the angular part of the solution to the Laplace Equation in spherical coordinates. Here, it is important to identify the coordinates to be used, as, for instance, spherical coordinates have often two different interpretations, one, which is mainly used by physicist, uses the latitude [...] as one of the angular coordinates, while the other, 

Here, the spherical coordinates are taken to be
\begin{itemize} 
\item[] $r$, the radial distance from Earth's center
\item[] $\lambda$, the East longitude % Bounded between... % ...write nicer
\item[] $\theta$, the co-latitude, defined to be $\theta = \frac{\pi}{2} - \theta'$, with $\theta'$ the latitude. % Bounded between... % ...write nicer
\end{itemize}


The magnetic field is given by the negative gradient of the potential $V$ defined for $r \geq R_e$, and given by the spherical harmonic approximation

\begin{equation}
V = r \sum_{n=1}^{N} \left(\dfrac{R_e}{r}\right)^{n+1} \left(g_n^m cos(m\lambda) + h_n^m sin(m\lambda)\right) P_n^m(\theta)
\end{equation}

That is
\begin{equation}
{\bm \beta} = -\nabla V
\end{equation}


Where $g_n^m$ and $h_n^m$ are the set of IGRF gaussian coefficients, published and revised every five years by the participating members of the IAGA (International Association
of Geomagnetism and Aeronomy). The $12^{th}$ generation is here used, as the last revision by the time of this work. These coefficient also include the secular variation (SV), which bestow the model on the proper time dependence.

$P_n^m(cos \theta)$ are the Schmidt normalized associated Legendree polynomials of degree n and order m

One can find very effective, recursive ways of computing the Schmidt quasi-normalization factors, the Associated Legendre polynomials and its derivatives, as can be found on [J.Davis - Mathematical Modeling of Earthâ€™s Magnetic Field] %\cite{...}